{"ast":null,"code":"var _jsxFileName = \"C:\\\\Capstone_Project\\\\testing\\\\src\\\\main\\\\frontend\\\\src\\\\pages\\\\Main.js\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport { useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useRecoilState } from \"recoil\";\nimport NavBar from \"../components/NavBar\";\nimport { isWorkingState, userState } from \"../recoil/atom\";\nimport WorkChart from \"../components/WorkChart\";\nimport BarChart from \"../components/BarChart\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Main = () => {\n  _s();\n\n  const [user, setUser] = useRecoilState(userState);\n  const [isWorking, setIsWorking] = useRecoilState(isWorkingState);\n  const navigate = useNavigate();\n\n  const validateLocation = (myLat, myLong, latitude, longitude) => {\n    const diffLat = Math.abs(myLat - latitude);\n    const diffLong = Math.abs(myLong - longitude);\n    if (diffLat < 0.005 && diffLong < 0.005) return true;\n    return false;\n  };\n\n  const getCurrentTime = () => {\n    const date = new Date();\n    const [hour, minute] = date.toTimeString().split(\" \")[0].split(\":\");\n    const [year, month, day] = date.toLocaleString().split(\". \");\n    return `${year}-${month}-${day}T${hour}:${minute}`;\n  };\n\n  const handleStart = () => {\n    const date = new Date();\n    const [hour, minute] = date.toTimeString().split(\" \")[0].split(\":\");\n    const [year, month, day] = date.toLocaleString().split(\". \");\n    console.log(\"분\", minute);\n    const startTime = getCurrentTime();\n    navigator.geolocation.getCurrentPosition(position => {\n      axios.get(`/api/work/start/location/${user.teamId}`).then(response => {\n        const {\n          latitude,\n          longitude\n        } = response.data;\n        const isValid = validateLocation(position.coords.latitude, position.coords.longitude, longitude, latitude);\n\n        if (!isValid) {\n          alert(\"위치에서 벗어났습니다.\");\n          return;\n        }\n\n        axios.post(`/api/work/start/${user.id}`, {\n          work_start_time: startTime\n        }).then(response => {\n          setIsWorking(true);\n          alert(\"근무를 시작합니다.\");\n        }).catch(err => console.error(err.message));\n      });\n    }, error => {\n      console.error(error);\n    }, {\n      enableHighAccuracy: false,\n      maximumAge: 0,\n      timeout: Infinity\n    });\n  };\n\n  const handleEnd = () => {\n    axios.post(`/api/work/end/${user.id}`, {\n      work_end_time: getCurrentTime()\n    }).then(response => {\n      setIsWorking(false);\n      alert(\"근무를 종료합니다.\");\n    }).catch(err => console.error(err.message));\n  };\n\n  useEffect(() => {\n    if (!user.id) {\n      const cache = JSON.parse(localStorage.getItem(\"user\"));\n      if (!cache) navigate(\"/login\");\n      setUser(cache);\n    }\n\n    axios.get(`/api/member/myteam/${user.id}`).then(response => {\n      const teamId = response.data;\n      setUser({ ...user,\n        teamId: teamId\n      });\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(NavBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"\\uBA54\\uC778 \\uD398\\uC774\\uC9C0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleStart,\n      disabled: isWorking,\n      children: \"Start\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleEnd,\n      children: \"End\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: user.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: user.admin\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(WorkChart, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(BarChart, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Main, \"S5vvnYn4DcICpvbpNShkUMCLo+g=\", false, function () {\n  return [useRecoilState, useRecoilState, useNavigate];\n});\n\n_c = Main;\nexport default Main;\n\nvar _c;\n\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"names":["axios","useEffect","useNavigate","useRecoilState","NavBar","isWorkingState","userState","WorkChart","BarChart","Main","user","setUser","isWorking","setIsWorking","navigate","validateLocation","myLat","myLong","latitude","longitude","diffLat","Math","abs","diffLong","getCurrentTime","date","Date","hour","minute","toTimeString","split","year","month","day","toLocaleString","handleStart","console","log","startTime","navigator","geolocation","getCurrentPosition","position","get","teamId","then","response","data","isValid","coords","alert","post","id","work_start_time","catch","err","error","message","enableHighAccuracy","maximumAge","timeout","Infinity","handleEnd","work_end_time","cache","JSON","parse","localStorage","getItem","name","admin"],"sources":["C:/Capstone_Project/testing/src/main/frontend/src/pages/Main.js"],"sourcesContent":["import axios from \"axios\";\nimport { useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useRecoilState } from \"recoil\";\nimport NavBar from \"../components/NavBar\";\nimport { isWorkingState, userState } from \"../recoil/atom\";\nimport WorkChart from \"../components/WorkChart\";\nimport BarChart from \"../components/BarChart\";\n\nconst Main = () => {\n  const [user, setUser] = useRecoilState(userState);\n  const [isWorking, setIsWorking] = useRecoilState(isWorkingState);\n  const navigate = useNavigate();\n\n  const validateLocation = (myLat, myLong, latitude, longitude) => {\n    const diffLat = Math.abs(myLat - latitude);\n    const diffLong = Math.abs(myLong - longitude);\n    if (diffLat < 0.005 && diffLong < 0.005) return true;\n    return false;\n  };\n\n  const getCurrentTime = () => {\n    const date = new Date();\n    const [hour, minute] = date.toTimeString().split(\" \")[0].split(\":\");\n    const [year, month, day] = date.toLocaleString().split(\". \");\n    return `${year}-${month}-${day}T${hour}:${minute}`;\n  };\n\n  const handleStart = () => {\n    const date = new Date();\n    const [hour, minute] = date.toTimeString().split(\" \")[0].split(\":\");\n    const [year, month, day] = date.toLocaleString().split(\". \");\n    console.log(\"분\", minute);\n    const startTime = getCurrentTime();\n\n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        axios\n          .get(`/api/work/start/location/${user.teamId}`)\n          .then((response) => {\n            const { latitude, longitude } = response.data;\n            const isValid = validateLocation(\n              position.coords.latitude,\n              position.coords.longitude,\n              longitude,\n              latitude\n            );\n\n            if (!isValid) {\n              alert(\"위치에서 벗어났습니다.\");\n              return;\n            }\n\n            axios\n              .post(`/api/work/start/${user.id}`, {\n                work_start_time: startTime,\n              })\n              .then((response) => {\n                setIsWorking(true);\n                alert(\"근무를 시작합니다.\");\n              })\n              .catch((err) => console.error(err.message));\n          });\n      },\n      (error) => {\n        console.error(error);\n      },\n      {\n        enableHighAccuracy: false,\n        maximumAge: 0,\n        timeout: Infinity,\n      }\n    );\n  };\n\n  const handleEnd = () => {\n    axios\n      .post(`/api/work/end/${user.id}`, {\n        work_end_time: getCurrentTime(),\n      })\n      .then((response) => {\n        setIsWorking(false);\n        alert(\"근무를 종료합니다.\");\n      })\n      .catch((err) => console.error(err.message));\n  };\n  useEffect(() => {\n    if (!user.id) {\n      const cache = JSON.parse(localStorage.getItem(\"user\"));\n      if (!cache) navigate(\"/login\");\n      setUser(cache);\n    }\n\n    axios.get(`/api/member/myteam/${user.id}`).then((response) => {\n      const teamId = response.data;\n      setUser({ ...user, teamId: teamId });\n    });\n  }, []);\n  return (\n    <>\n      <NavBar />\n      <div>메인 페이지</div>\n      <button onClick={handleStart} disabled={isWorking}>\n        Start\n      </button>\n      <button onClick={handleEnd}>End</button>\n      <h1>{user.name}</h1>\n      <h1>{user.admin}</h1>\n      <WorkChart />\n      <BarChart />\n    </>\n  );\n};\n\nexport default Main;"],"mappings":"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"},"metadata":{},"sourceType":"module"}